<html>
  <head>
    <script type="text/javascript" src="https://www.google.com/jsapi?autoload={'modules':[{'name':'visualization','version':'1','packages':['annotationchart']}]}"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script type='text/javascript'>
      google.load('visualization', '1', {'packages':['annotationchart']});
      google.setOnLoadCallback(drawChart);
      function processData(allText){
        //alert(data);
         var allTextLines = allText.split(/\r\n|\n/);
         var headers = allTextLines[0].split(',');
         var lines = [];

        //var headings = entries.splice(0,record_num);
       for (var i=1; i<allTextLines.length; i++) {
            var data = allTextLines[i].split(',');
            var tarr = [];
            if(data[2] && data[1]){
                tarr.push(new Date(data[2].trim()));
                tarr.push(parseFloat(data[1].trim()));
                lines.push(tarr);
            }
        }
        return lines
      }
      
      function loadData(){
          var loaddedData = [];
          $.ajax({
            type: "GET",
            async: false,
            url: "data_archive.csv",
            dataType: "text",
            success: function(data) {
                loaddedData = processData(data);
            }
         });
         return loaddedData;
      }
      
      function drawChart() {
        var data = new google.visualization.DataTable();
        data.addColumn('date', 'Data');
        data.addColumn('number', 'Temperatura');

        var loadedData = loadData();
        //console.log(JSON.stringify(loadedData));
        data.addRows( loadedData);

/*        data.addRows(        
        [
            [ new Date("2015-01-03T11:48:43"),17.562], 
            [ new Date("2015-01-03T11:53:44"), 17.687], 
            [ new Date("2015-01-03T11:58:45"),17.562], 
            [ new Date("2015-01-03T12:03:46"),17.562], 
            [ new Date("2015-01-03T12:08:48"),17.625], 
            [ new Date("2015-01-03T12:13:48"),17.562], 
            [ new Date("2015-01-03T12:18:49"),17.5], 
            [ new Date("2015-01-03T12:23:50"),17.437], 
            [ new Date("2015-01-03T12:28:51"),17.437], 
            [ new Date("2015-01-03T12:33:52"),17.375], 
            [ new Date("2015-01-03T12:38:53"),17.437], 
            [ new Date("2015-01-03T12:43:54"),17.5], 
            [ new Date("2015-01-03T12:48:55"),17.437]
        ]);*/

        var chart = new google.visualization.AnnotationChart(document.getElementById('chart_div'));

        var options = {
          //displayAnnotations: true
        };

        chart.draw(data, options);
      }
    </script>
  </head>
  <body>
    <div id='chart_div' style='width: 900px; height: 500px;'></div>
  </body>
</html>

